[build]
  command = "npm run build"
  publish = "dist"
  environment = { NODE_VERSION = "20" }

[functions]
  node_bundler = "esbuild"

# Hashed assets (JS/CSS generated by Astro) - Immutable
[[headers]]
  for = "/_astro/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Fonts - Immutable
[[headers]]
  for = "/*.woff2"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
[[headers]]
  for = "/*.ttf"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Images - Caching for 1 week (since they might change without filename hash)
[[headers]]
  for = "/images/*"
  [headers.values]
    Cache-Control = "public, max-age=604800, stale-while-revalidate=86400"

# Favicon/general icons
[[headers]]
  for = "/*.ico"
  [headers.values]
    Cache-Control = "public, max-age=604800"
