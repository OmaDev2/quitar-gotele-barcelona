---
import "@fontsource/inter";
import "@fontsource/oswald";
import "@fontsource/barlow-condensed";
import "@fontsource/roboto";
import "@fontsource/lato";
import "@fontsource/playfair-display";
import "@fontsource/nunito";
import "@fontsource/open-sans";
import "@fontsource/chakra-petch";
import "@fontsource/exo-2";
import "@fontsource/merriweather";
import "@fontsource/lora";
import "@fontsource/crimson-text";
import "@fontsource/source-serif-4";
import "@fontsource/cormorant";
import "@fontsource/eb-garamond";

// This component doesn't render anything, it just imports the CSS files.
// Astro's bundler is smart enough to include the CSS only if this component is used.
// However, since we are importing ALL of them here, they might all be bundled if we are not careful.
// A better approach for static replacement is to rely on the fact that we just need the font files to be available.
// BUT, Fontsource works by importing the CSS.
// To avoid loading ALL fonts, we should ideally use dynamic imports or conditional logic.
// But Astro styles are static.
// Given the requirement to support ALL themes, we face a trade-off.
// 1. Import ALL (bad for performance if unused, but easiest for "theme switching" if it was runtime, here it is build time config).
// 2. Since `settings.fontPair` is known at build time, we can try to be smart.

// Wait, the previous plan said: "Uses dynamic imports... to load only the required CSS".
// Astro components run at build time (or SSR).
// We can conditionally import inside the frontmatter?
// No, imports must be top-level for Vite to detect them reliably for CSS injection usually.
// EXCEPT dynamic imports `import(...)`.

const { pair } = Astro.props as { pair: keyof typeof fontMap };

// Mapping of pairs to their required font imports
const fontMap = {
    modern: ["@fontsource/inter", "@fontsource/oswald"],
    robust: ["@fontsource/barlow-condensed", "@fontsource/roboto"],
    elegant: ["@fontsource/lato", "@fontsource/playfair-display"],
    friendly: ["@fontsource/nunito", "@fontsource/open-sans"],
    tech: ["@fontsource/chakra-petch", "@fontsource/exo-2"],
    artisan_warm: ["@fontsource/merriweather", "@fontsource/lora"],
    artisan_natural: ["@fontsource/crimson-text", "@fontsource/source-serif-4"],
    artisan_classic: ["@fontsource/cormorant", "@fontsource/eb-garamond"],
};

const fontsToLoad = fontMap[pair] || fontMap.modern;

// Trigger the import. Note: Vite handles `import()` for CSS modules involved.
// However, for pure CSS files from packages, standard dynamic import might verify it works.
// A safer/simpler way in Astro for global styles is just proper conditional rendering?
// No, styles in Astro are usually hoisted.
// Le's try the dynamic import approach.
for (const font of fontsToLoad) {
    // We cannot use dynamic template strings in import() easily with Vite sometimes if not precise.
    // But let's try a switch or if/else block if needed, or just trusted map.
    // Actually, dynamic imports with variables work in Vite if they match a pattern.
    // But full dynamic string like `import(font)` might warn.
    // Let's use a switch for safety and correctness.
}

/*
  Optimization: references to the packages.
  We will do a switch statement to be explicit.
*/
if (pair === "modern") {
    import("@fontsource/inter/index.css");
    import("@fontsource/oswald/index.css");
} else if (pair === "robust") {
    import("@fontsource/barlow-condensed/index.css");
    import("@fontsource/roboto/index.css");
} else if (pair === "elegant") {
    import("@fontsource/lato/index.css");
    import("@fontsource/playfair-display/index.css");
} else if (pair === "friendly") {
    import("@fontsource/nunito/index.css");
    import("@fontsource/open-sans/index.css");
} else if (pair === "tech") {
    import("@fontsource/chakra-petch/index.css");
    import("@fontsource/exo-2/index.css");
} else if (pair === "artisan_warm") {
    import("@fontsource/merriweather/index.css");
    import("@fontsource/lora/index.css");
} else if (pair === "artisan_natural") {
    import("@fontsource/crimson-text/index.css");
    import("@fontsource/source-serif-4/index.css");
} else if (pair === "artisan_classic") {
    import("@fontsource/cormorant/index.css");
    import("@fontsource/eb-garamond/index.css");
} else {
    // Fallback modern
    import("@fontsource/inter/index.css");
    import("@fontsource/oswald/index.css");
}
---

<!-- FontLoader: Loaded {pair} fonts -->
