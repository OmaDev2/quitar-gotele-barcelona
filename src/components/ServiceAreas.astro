---
import { getCollection } from "astro:content";

const locations = await getCollection("locations");

// Ordenar alfabéticamente
const sortedLocations = locations.sort((a, b) =>
    a.data.name.localeCompare(b.data.name),
);

// Agrupar por categorías para mostrarlo ordenado (Opcional, si prefieres lista plana elimina esto)
const categories = {
    residencial: sortedLocations.filter((l) => l.data.type === "residencial"),
    industrial: sortedLocations.filter((l) => l.data.type === "industrial"),
    centro: sortedLocations.filter((l) => l.data.type === "centro"),
};

interface Props {
    slim?: boolean;
}

const { slim = false } = Astro.props;
---

<div class={slim ? "" : "space-y-6"}>
    {
        !slim && (
            <div class="text-heading font-bold uppercase tracking-wider text-sm mb-4">
                Zonas de Servicio
            </div>
        )
    }

    {/* Lista vertical flexible */}
    <div class={slim ? "space-y-3" : "flex flex-col gap-y-3"}>
        {
            sortedLocations.map((location) => (
                <a
                    href={`/zona/${location.slug}/`}
                    class="group flex items-center gap-2 text-sm text-gray-400 hover:text-primary transition-colors"
                >
                    {/* Bullet point estilo herrerozaragoza */}
                    <span class="w-1.5 h-1.5 rounded-full bg-primary shrink-0 opacity-80 group-hover:opacity-100 transition-opacity" />
                    <span
                        class={`${slim ? "" : "group-hover:translate-x-1"} transition-transform duration-300 truncate`}
                    >
                        {location.data.name}
                    </span>
                </a>
            ))
        }
    </div>

    {
        !slim && (
            <div class="pt-4 border-t border-heading/10">
                <a
                    href="/zonas/"
                    class="inline-flex items-center text-sm font-bold text-primary hover:text-accent transition-colors"
                >
                    Ver cobertura completa en el mapa →
                </a>
            </div>
        )
    }
</div>
