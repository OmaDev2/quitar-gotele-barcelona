---
import { HelpCircle, ChevronDown } from "lucide-react";
import { marked } from "marked";

interface Props {
    title?: string;
    items: {
        question: string;
        answer: string;
    }[];
}

const { title = "Preguntas Frecuentes", items } = Astro.props;
---

<div
    class="bg-secondary border border-heading/10 rounded-xl p-8 shadow-2xl relative overflow-hidden my-8"
>
    <div
        class="absolute top-0 right-0 w-32 h-32 bg-primary/5 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none"
    >
    </div>

    {
        title && (
            <div class="flex items-center gap-3 mb-8 border-b border-heading/10 pb-6 relative z-10">
                <div class="p-2 bg-primary/10 rounded-lg text-primary">
                    <HelpCircle className="w-6 h-6" />
                </div>
                <h2 class="text-2xl font-heading font-bold text-heading">
                    {title}
                </h2>
            </div>
        )
    }

    <div class="space-y-4 relative z-10">
        {
            items.map((item) => (
                <details class="group bg-surface/50 rounded-lg border border-heading/5 transition-all duration-300 hover:border-primary/30 open:border-primary/50 open:shadow-lg open:shadow-primary/10">
                    <summary class="flex justify-between items-center w-full p-5 cursor-pointer list-none text-left">
                        <h3 class="font-bold text-heading group-hover:text-primary transition-colors pr-8 text-base m-0">
                            {item.question}
                        </h3>

                        <span class="text-body/70 group-open:text-primary transition-transform duration-300 group-open:rotate-180 shrink-0">
                            <ChevronDown className="w-5 h-5" />
                        </span>
                    </summary>

                    <div class="px-5 pb-5 pt-0 text-body text-sm leading-relaxed border-t border-transparent group-open:border-heading/5 animate-fadeIn">
                        <div
                            class="pt-3 prose prose-sm max-w-none prose-headings:text-heading prose-p:text-body prose-strong:text-heading"
                            set:html={marked.parse(item.answer)}
                        />
                    </div>
                </details>
            ))
        }
    </div>
</div>

<style>
    /* Animaci√≥n suave al abrir */
    details[open] summary ~ * {
        animation: sweep 0.3s ease-in-out;
    }

    @keyframes sweep {
        0% {
            opacity: 0;
            transform: translateY(-10px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>
